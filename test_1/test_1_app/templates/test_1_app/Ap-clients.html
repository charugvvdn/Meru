<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>AP with number of clients Connected</title>

    <!--[if lte IE 8]><script language="javascript" type="text/javascript" src="../excanvas.min.js"></script>
    <![endif]-->
    <script language="javascript" type="text/javascript" src="http://www.flotcharts.org/flot/jquery.js"></script>
    <script language="javascript" type="text/javascript" src="http://www.flotcharts.org/flot/jquery.flot.js"></script>
    <script language="javascript" type="text/javascript" src="http://www.flotcharts.org/flot/jquery.flot.time.js"></script>
</head>
<body>
<h1>AP with number of clients Connected</h1>

<div id="placeholder" style="width:600px;height:300px;"></div>


<script type="text/javascript">
var ap_data = new Array()

$(document).ready(function () {
    $("<div id='tooltip'></div>").css({
            position: "absolute",
            display: "none",
            border: "1px solid #fdd",
            padding: "2px",
            "background-color": "#fee",
            opacity: 0.80
        }).appendTo("body");

    var options = {
            series: {
                stack: 1,
                bars: {
                            show: true,
                            barWidth: 12*24*60,
                            fill: true,
                            lineWidth: 1,
                            order: 1,
                            fillColor:  "#AA4643"
                        }
            },
            grid: {
                hoverable: true,
                clickable: true
            },
            xaxis: {
                mode: "time",
                /* minTickSize: [1, "hour"],
                 min: (new Date("2013/12/09")).getTime(),
                 max: (new Date("2013/12/10")).getTime(),*/
                timeformat: "%H:%M:%S"
            }
        };
    $.ajax({
            type: "POST",
            url: "http://localhost:8000/meru-nms/reports/ap_clients/",
            data: '{"mac" : ["AA:BB:CC:DD:00:DD"],"time":[1387188904000,1387188907000]}',
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (result) {
                if (result['status'] == 'true') {
                    
                    for (var i = 0; i < result['values'].length; i++) {
                        ap_data.push([result['values'][i]['data']])
                        
                    }
                    
                    /*var d1_3 = [
                        [1325376000000, 80],
                        [1328054400000, 40],
                        [1330560000000, 30],
                        [1333238400000, 20],
                        [1335830400000, 10]
                    ];
                    
                    var data1 = [
                    {
                        
                        data: d1_3,
                        
                    }];*/
                    
                    $.plot($("#placeholder"), ap_data, options);
                  $("#placeholder").bind("plotclick", function (event, pos, item) {
                        if (item) {
                            $("#clickdata").text(" - click point " + item.dataIndex + " in " + item.series.label);
                            plot.highlight(item.series, item.datapoint);
                        }
                    });
                 
                    $("#placeholder").bind("plothover", function (event, pos, item) {

                        //if ($("#enablePosition:checked").length > 0) {
                        var str = "(" + pos.x.toFixed(2) + ", " + pos.y.toFixed(2) + ")";
                        $("#hoverdata").text(str);
                        //}

                        //if ($("#enableTooltip:checked").length > 0) {
                        if (item) {

                            var x = item.datapoint[0],
                                    y = item.datapoint[1];

                            var date = new Date(x);
                            var h = date.getUTCHours()
                            var m = date.getUTCMinutes()
                            var s = date.getUTCSeconds()
                            var formatted_date = h + ":" + m + ":" + s;

                            $("#tooltip").html(item.series.label + " of " + formatted_date + " = " + y)
                                    .css({top: item.pageY + 5, left: item.pageX + 5})
                                    .fadeIn(200);
                        } else {
                            $("#tooltip").hide();
                        }
                        //}
                    });
                }
            }
        });
    
});
</script>
</head>
 
<body>
    
    <div id="placeholder"></div>
</body>
</html>

